<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Collect Clock</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg: #050814;
      --card: rgba(20, 26, 46, 0.6);
      --border: rgba(31, 37, 56, 0.5);
      --text: #e8ebff;
      --muted: #9aa4ff;
      --ready: #00ffa3;
      --soon: #ffb020;
      --later: #ff5c5c;
      --accent: rgba(43, 51, 80, 0.8);
      --glass-blur: blur(12px);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      background-color: var(--bg);
      color: var(--text);
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background-image:
        radial-gradient(circle at 10% 10%, rgba(0, 255, 163, 0.05), transparent 25%),
        radial-gradient(circle at 90% 90%, rgba(154, 164, 255, 0.05), transparent 25%);
      background-attachment: fixed;
      min-height: 100vh;
    }

    header {
      padding: 20px;
      border-bottom: 1px solid var(--border);
      background: rgba(5, 8, 20, 0.8);
      backdrop-filter: var(--glass-blur);
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    header h1 {
      margin: 0;
      font-size: 20px;
      background: linear-gradient(45deg, #e8ebff, #9aa4ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .search-box {
      background: var(--card);
      border: 1px solid var(--border);
      padding: 8px 16px;
      border-radius: 20px;
      color: var(--text);
      width: 250px;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .search-box:focus {
      outline: none;
      border-color: var(--ready);
      box-shadow: 0 0 15px rgba(0, 255, 163, 0.2);
      width: 300px;
    }

    .next-ready {
      width: 100%;
      background: rgba(15, 21, 36, 0.6);
      backdrop-filter: var(--glass-blur);
      border-bottom: 1px solid var(--border);
      padding: 10px 20px;
      font-size: 13px;
      color: var(--muted);
      text-align: center;
      font-weight: 500;
    }

    .section-heading {
      padding: 24px 20px 8px;
      font-size: 16px;
      font-weight: 600;
      color: var(--ready);
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .container {
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
    }

    .card {
      background: var(--card);
      backdrop-filter: var(--glass-blur);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      cursor: pointer;
      position: relative;
      min-height: 120px;
      box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      animation: fadeIn 0.5s ease-out forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card:hover {
      transform: translateY(-8px) scale(1.02);
      border-color: var(--ready);
      box-shadow: 0 12px 40px 0 rgba(0, 255, 163, 0.15);
    }

    .card h3 {
      margin: 0;
      font-size: 18px;
      letter-spacing: -0.5px;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      width: fit-content;
    }

    .badge-ready { background: rgba(0, 255, 163, 0.1); color: var(--ready); border: 1px solid rgba(0, 255, 163, 0.2); }
    .badge-soon { background: rgba(255, 176, 32, 0.1); color: var(--soon); border: 1px solid rgba(255, 176, 32, 0.2); }
    .badge-later { background: rgba(255, 92, 92, 0.1); color: var(--later); border: 1px solid rgba(255, 92, 92, 0.2); }

    .meta {
      font-size: 12px;
      color: var(--muted);
      margin-top: auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* options button */
    .opts {
      position: absolute;
      right: 12px;
      top: 12px;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(255, 255, 255, 0.05);
      color: var(--muted);
      border: 1px solid var(--border);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .opts:hover { background: var(--ready); color: var(--bg); border-color: var(--ready); }

    /* small popover form */
    .popover {
      position: absolute;
      right: 12px;
      top: 48px;
      background: #141a2e;
      border: 1px solid var(--ready);
      padding: 16px;
      border-radius: 12px;
      width: 260px;
      z-index: 40;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      backdrop-filter: var(--glass-blur);
    }
    .popover label {
      display:block;
      font-size:11px;
      color:var(--muted);
      margin-bottom:6px;
      text-transform: uppercase;
      font-weight: 700;
    }
    .popover input[type="number"],
    .popover input[type="text"] {
      width:100%;
      padding:10px 12px;
      border-radius:8px;
      border:1px solid var(--border);
      background:rgba(0,0,0,0.3);
      color:var(--text);
      margin-bottom:12px;
      font-size:13px;
    }
    .popover .row {
      display:flex;
      gap:10px;
    }
    .popover button {
      flex:1;
      padding:10px;
      border-radius:8px;
      border:1px solid var(--border);
      background:transparent;
      color:var(--text);
      cursor:pointer;
      font-weight: 600;
      font-size: 13px;
    }
    .popover button.save { background:var(--ready); color:var(--bg); border-color:transparent; }
    .popover button.cancel { background:transparent; color:var(--muted); }

    footer {
      padding: 40px 20px;
      color: var(--muted);
      font-size: 12px;
      text-align: center;
      opacity: 0.6;
    }

  </style>
</head>

<body>
  <header>
    <h1>ðŸŽ° Collect Clock</h1>
    <input type="text" class="search-box" placeholder="Search casinos..." id="searchInp">
  </header>

  <div id="nextReady" class="next-ready"></div>

  <div class="section-heading">Casino Bonuses</div>
  <div class="container" id="cards"></div>

  <div class="section-heading">Get Paid To Sites</div>
  <div class="container" id="paidCards"></div>

  <footer>MADE FOR DEGENS BY DEGENS</footer>

  <script>
    let searchTerm = "";
    document.getElementById("searchInp").addEventListener("input", (e) => {
      searchTerm = e.target.value.toLowerCase();
      render();
      renderPaid();
    });

    // initial list (as before) â€” we'll store per-site cooldownHours and optional bonusDetails
    let state = [
      { name:"HelloMillions", url:"https://www.hellomillions.com/lp/raf?r=26d6760f%2F1236643867" },
      { name:"SpinBlitz", url:"https://www.spinblitz.com/lp/raf?r=606f64a3%2F1246446739" },
      { name:"MegaBonanza", url:"https://www.megabonanza.com/?r=72781897" },
      { name:"RealPrize", url:"https://www.realprize.com/refer/317136" },
      { name:"WOW Vegas", url:"https://www.wowvegas.com/?raf=3615494" },
      { name:"Pulsz", url:"https://www.pulsz.com/?invited_by=utfk4r" },
      { name:"Modo", url:"https://modo.us?referralCode=61MN6A" },
      { name:"McLuck", url:"https://www.mcluck.com/lp/raf?r=61119407%2F908900038" },
      { name:"Crown Coins", url:"https://crowncoinscasino.com/?utm_campaign=59048bf4-dbeb-4c58-b690-d7ad11bdb847&utm_source=friends" },
      { name:"Chanced", url:"https://chanced.com/c/ysa096" },

      { name:"Stake.us", url:"https://stake.us/?c=Jmenichole" },
      { name:"Sportzino", url:"https://sportzino.com/signup/8a105ba6-7ada-45c8-b021-f478ac03c7c4" },
      { name:"PlayFame", url:"https://www.playfame.com/lp/raf?r=1275975417" },
      { name:"Pulsz Bingo", url:"https://www.pulszbingo.com/?invited_by=eg6mbf" },
      { name:"Jackpota", url:"https://www.jackpota.com/?r=85453282" },
      { name:"Zula Casino", url:"https://www.zulacasino.com/signup/221ddd92-862e-45d8-acc0-4cd2c26f7cdd" },
      { name:"Fortune Coins", url:"https://www.fortunecoins.com/signup/3c08936f-8979-4f87-b377-efdbff519029" },
      { name:"MyPrize", url:"https://myprize.us/invite/jmenichole" },
      { name:"Winna", url:"https://winna.com/?r=jmenichole" },
      { name:"Clubs Poker", url:"https://play.clubs.poker/?referralCode=104192" },

      { name:"Rolla", url:"https://www.rolla.com/?raf=3873" },
      { name:"Lone Star Casino", url:"https://lonestarcasino.com/refer/678504" },
      { name:"Spree", url:"https://spree.com/?r=1450539" },
      { name:"SpinPals", url:"https://www.spinpals.com?referralcode=e851e1a8-c455-4a59-954d-b7fe0bbad04c" },
      { name:"High 5 Casino", url:"https://high5casino.com/gc?adId=INV001%3AJmenichole" },
      { name:"TrustDice", url:"https://trustdice.win/faucet/?ref=u_jmenichole" },
      { name:"Punt", url:"https://punt.com/c/cg60pd" },
      { name:"FortuneWheelz", url:"https://fortunewheelz.com/?invited_by=P36ZS6" },
      { name:"Zoot", url:"https://getzoot.us/?referralCode=ZOOTwithJMENICHOLE" },
      { name:"Spinsala", url:"https://spinsala.com/en?invite=daym" },

      { name:"Legendz", url:"https://legendz.com/?referred_by_id=221602" },
      { name:"NoLimit Coins", url:"https://nolimitcoins.com/?invited_by=ZI1JIU" },
      { name:"Gamba", url:"https://gamba.com?c=Jme" },
      { name:"American Luck", url:"https://americanluck.com/signup/e360918f-8986-4dec-9823-a902d3f4936a" },
      { name:"Goated", url:"https://www.goated.com/r/YDRZLJ" },
      { name:"Shuffle", url:"https://shuffle.com?r=jHR7JnWRPF" },
      { name:"Stake (Global)", url:"https://www.stake.com/?c=LAYP68hb" },
      { name:"Clash.gg", url:"https://clash.gg/r/stakestats" },
      { name:"Cases.gg", url:"https://www.cases.gg/r/JMENICHOLE" },
      { name:"Jemlit", url:"https://jemlit.com/en/a/Jmenichole" },

      { name:"RoxyMoxy", url:"https://roxymoxy.com/home?invite=f94f874427" },
      { name:"LuckyLand Slots", url:"https://luckylandslots.com" },
      { name:"LuckyBits Vegas", url:"https://luckybitsvegas.com/gc?adId=INV001%3Ajmenichole" },
      { name:"Shuffle.us", url:"https://shuffle.us?r=Rl93OJoflX" },
      { name:"Kickr", url:"https://kickr.com/signup/doxe8c09" }
    ]
    // default properties: cooldownHours (hours between collects) and optional bonusDetails
    .map(c => ({ ...c, cooldownHours: 24, bonusDetails: "", lastCollected: null }));

    // Static Get Paid To Sites list â€” unchanged
    const paidSites = [
      { name: "Auto-mine Bitcoin Daily To Play Casino Games", url: "https://emberfund.onelink.me/ljTI/l4g18zii?mining_referrer_id=MNGX1VVREUE" },
      { name: "FreeCash Surveys & Games", url: "https://freecash.com/r/IAI3V" },
      { name: "Share unused bandwidth and get paid (Honeygain)", url: "https://join.honeygain.com/JAMIE864F2" },
      { name: "Web3 platform for micro-tasking: side hu$tle (Jumptask)", url: "https://www.jumptask.io/r/sopypokofuvi" },
      { name: "Discover high paying crypto bounties (Superteam Earn)", url: "https://www.earn.superteam.fun/r/KRNMB6H" },
      { name: "Get free gift cards for doing things online (Swagbucks)", url: "https://www.swagbucks.com/profile/Jmenichole?rp=1" }
    ];

    const STORAGE_KEY = "collectClockFull";

    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
    function load(){
      const s = localStorage.getItem(STORAGE_KEY);
      if (s) {
        try {
          const parsed = JSON.parse(s);
          // keep backward compatibility: if some items don't have bonusDetails/cooldownHours, set defaults
          state = parsed.map(item => ({
            ...item,
            cooldownHours: item.cooldownHours ?? 24,
            bonusDetails: item.bonusDetails ?? "",
            lastCollected: item.lastCollected ?? null
          }));
        } catch(e) {
          console.error("Failed to parse stored state:", e);
        }
      }
    }

    // milliseconds remaining until next availability
    function remaining(c){
      if (!c.lastCollected) return 0;
      return Math.max(0, (c.lastCollected + c.cooldownHours*3600000) - Date.now());
    }

    function fmt(ms){
      if (!ms || ms <= 0) return "0h 0m";
      const m = Math.ceil(ms/60000);
      return `${Math.floor(m/60)}h ${m%60}m`;
    }

    // create and show a small popover on the card to edit cooldownHours and bonusDetails
    function showEditPopover(cardElem, c) {
      // remove existing popovers
      document.querySelectorAll(".popover").forEach(p => p.remove());

      const pop = document.createElement("div");
      pop.className = "popover";

      pop.innerHTML = `
        <label>Collection interval (hours)</label>
        <input type="number" min="1" step="1" id="p-cool" value="${c.cooldownHours}">
        <label>Bonus details (optional)</label>
        <input type="text" id="p-details" placeholder="e.g. $1.00 spin, 12hr window" value="${escapeHtml(c.bonusDetails)}">
        <div class="row">
          <button class="cancel">Cancel</button>
          <button class="save">Save</button>
        </div>
      `;

      // stop clicks inside popover from closing/propagating
      pop.addEventListener("click", e => e.stopPropagation());

      const inpCool = pop.querySelector("#p-cool");
      const inpDetails = pop.querySelector("#p-details");
      const btnSave = pop.querySelector("button.save");
      const btnCancel = pop.querySelector("button.cancel");

      btnCancel.addEventListener("click", (ev) => {
        ev.stopPropagation();
        pop.remove();
      });

      btnSave.addEventListener("click", (ev) => {
        ev.stopPropagation();
        const newHours = parseInt(inpCool.value, 10) || 24;
        c.cooldownHours = newHours;
        c.bonusDetails = inpDetails.value.trim();
        save();
        render(); // re-render card (and meta)
        pop.remove();
      });

      // attach and close when clicking elsewhere
      cardElem.appendChild(pop);
      // close popover if clicking anywhere else on document
      const onDocClick = () => { pop.remove(); document.removeEventListener("click", onDocClick); };
      setTimeout(() => document.addEventListener("click", onDocClick), 0);
    }

    // Escape minimal HTML for value attribute display
    function escapeHtml(str){
      return String(str || "").replace(/&/g, "&amp;").replace(/"/g, "&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
    }

    function render(){
      const root = document.getElementById("cards");
      root.innerHTML = "";

      const filtered = state.filter(c => c.name.toLowerCase().includes(searchTerm));
      const sorted = [...filtered].sort((a,b)=>remaining(a)-remaining(b));
      let ready = 0;

      for (const c of sorted){
        const r = remaining(c);
        if (!r) ready++;

        const card = document.createElement("div");
        card.className = "card";

        // clicking the card opens the link and records lastCollected (existing behavior)
        card.onclick = () => {
          c.lastCollected = Date.now();
          save();
          window.open(c.url, "_blank");
          render();
        };

        // options button
        const opts = document.createElement("div");
        opts.className = "opts";
        opts.title = "Edit bonus details";
        opts.textContent = "âš™";
        opts.addEventListener("click", (e) => {
          e.stopPropagation();
          showEditPopover(card, c);
        });
        card.appendChild(opts);

        // main inner html
        const statusClass = r ? (r < 3600000 ? "badge-soon" : "badge-later") : "badge-ready";
        const statusText = r ? fmt(r) : "READY";
        const bonusText = c.bonusDetails ? ` Â· ${c.bonusDetails}` : "";

        card.innerHTML += `
          <h3>${c.name}</h3>
          <div class="status-badge ${statusClass}">
            ${statusText}
          </div>
          <div class="meta">
            <span>Next: ${c.cooldownHours}h${bonusText}</span>
          </div>
        `;
        root.appendChild(card);
      }

      // compute next ready time if none ready
      const anyReady = state.filter(c => remaining(c) === 0).length;
      if (anyReady) {
        document.getElementById("nextReady").textContent = 
        `${anyReady} bonuses ready to collect`;
      } else {
        const allSorted = [...state].sort((a,b)=>remaining(a)-remaining(b));
        const nextSel = allSorted.map(s => ({s, r: remaining(s)})).filter(x => x.r > 0).sort((a,b)=>a.r-b.r)[0];
        if (nextSel) {
          document.getElementById("nextReady").textContent = `Next ready in ${fmt(nextSel.r)} â€” ${nextSel.s.name}`;
        } else {
          document.getElementById("nextReady").textContent = `All clear`;
        }
      }
    }

    // Render paid sites without any cooldown/lastCollected logic.
    function renderPaid(){
      const root = document.getElementById("paidCards");
      root.innerHTML = "";

      const filtered = paidSites.filter(s => s.name.toLowerCase().includes(searchTerm));

      for (const s of filtered){
        const card = document.createElement("div");
        card.className = "card";
        card.onclick = () => window.open(s.url, "_blank");

        card.innerHTML = `
          <h3>${s.name}</h3>
          <div class="status-badge badge-ready">REFERRAL</div>
          <div class="meta">Get Paid Site</div>
        `;
        root.appendChild(card);
      }
    }

    // bootstrap
    load();
    render();
    renderPaid();
    setInterval(()=>{
      render();
      // paid sites are static; re-rendering is harmless
      renderPaid();
    }, 60000);
  </script>
</body>
</html>