<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CollectClock</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .tooltip {
      position: relative;
      display: inline-block;
      cursor: help;
    }

    .tooltip .tooltiptext {
      visibility: hidden;
      width: max-content;
      background-color: #222;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }

    #gif-popup {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #000;
      border-radius: 12px;
      overflow: hidden;
      z-index: 999;
      display: none;
    }

    #gif-popup img {
      width: 200px;
      height: auto;
      display: block;
    }

    .dark-mode {
      background-color: #121212;
      color: #e0e0e0;
    }

    .dark-mode .table-header {
      background-color: #1e1e1e;
    }


    .table {
      display: grid;
      grid-template-columns: 2fr 1fr 2fr;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    .table-header, .table-row {
      display: contents;
    }
    .table-header > div, .table-row > div {
      padding: 14px 12px;
      border-radius: 10px;
      background: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      margin-bottom: 6px;
      font-size: 1rem;
      display: flex;
      align-items: center;
    }
    .table-header > div {
      font-weight: bold;
      background: linear-gradient(90deg, #e0e7ef 0%, #f5f7fa 100%);
      box-shadow: 0 1px 4px rgba(0,0,0,0.10);
    }
    .table-row > div {
      transition: box-shadow 0.2s, background 0.2s;
    }
    .table-row > div:hover {
      background: #f5f7fa;
      box-shadow: 0 4px 16px rgba(0,0,0,0.12);
    }
    .dark-mode .table-header > div, .dark-mode .table-row > div {
      background: #23272f;
      color: #e0e0e0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.18);
    }
    .dark-mode .table-header > div {
      background: linear-gradient(90deg, #23272f 0%, #2c2f36 100%);
      color: #e0e0e0;
    }

    .dark-mode .tooltip .tooltiptext {
      background-color: #333;
    }

    .toggle-mode {
      margin-top: 20px;
      padding: 10px 20px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .toggle-mode:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <div class="container">
    <img src="https://cdn.discordapp.com/embed/avatars/0.png" alt="Profile" class="profile-img" id="profile-img" style="display:none;" />
    <!-- Only one toggle button below -->
    <h1>CollectClock</h1>
    <p>Track your daily casino claims and referral earnings.</p>


    <a id="discord-login-btn" class="login-btn" href="#">Login with Discord</a>

    <button id="mode-toggle" class="toggle-mode">Toggle Mode</button>

    <div id="user-stats"></div>
    <div id="category-filters"></div>
    <div class="table" id="casino-table"></div>
    <div id="settings-panel" style="display:none;"></div>
  </div>

  <div id="gif-popup">
    <img src="" alt="funny gif" />
  </div>

  <script>
    const gifUrls = [
      "https://media.giphy.com/media/3og0IPxMM0erATueVW/giphy.gif",
      "https://media.giphy.com/media/1rNWzT3lbTi9K/giphy.gif",
      "https://media.giphy.com/media/l0MYEqEzwMWFCg8rm/giphy.gif",
      "https://media.giphy.com/media/3o6gE5aYpXz5E1ZkQo/giphy.gif"
    ];

    function toggleDegenMode() {
      document.body.classList.toggle("dark-mode");
      localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
    }

    function showGifPopup() {
      const gif = gifUrls[Math.floor(Math.random() * gifUrls.length)];
      const popup = document.getElementById("gif-popup");
      popup.querySelector("img").src = gif;
      popup.style.display = "block";
      setTimeout(() => popup.style.display = "none", 5000);
    }

    function updateTimers() {
      document.querySelectorAll(".table-row").forEach(row => {
        const casino = row.getAttribute("data-casino");
        const checkbox = row.querySelector(".collect-checkbox");
        const label = row.querySelector(".last-collected");
        const lastCollected = localStorage.getItem("casino_" + casino);
        const now = Date.now();

        if (lastCollected) {
          const diff = now - parseInt(lastCollected);
          const hoursLeft = 24 - (diff / (1000 * 60 * 60));
          if (hoursLeft > 0) {
            checkbox.checked = true;
            checkbox.disabled = true;
            label.textContent = `${hoursLeft.toFixed(1)}h until reset`;
          } else {
            checkbox.checked = false;
            checkbox.disabled = false;
            label.textContent = "Available!";
            localStorage.removeItem("casino_" + casino);
          }
        } else {
          checkbox.checked = false;
          checkbox.disabled = false;
          label.textContent = "Available!";
        }
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      if (localStorage.getItem("darkMode") === "true") {
        document.body.classList.add("dark-mode");
      }

      updateTimers();
      setInterval(updateTimers, 60000);

      let collectedCount = parseInt(localStorage.getItem("collect_count") || "0");

      document.querySelectorAll(".collect-checkbox").forEach(checkbox => {
        checkbox.addEventListener("change", () => {
          const row = checkbox.closest(".table-row");
          const casino = row.getAttribute("data-casino");

          if (checkbox.checked) {
            const confirmCollected = confirm("Did you collect your bonus?");
            if (confirmCollected) {
              localStorage.setItem("casino_" + casino, Date.now());
              collectedCount++;
              localStorage.setItem("collect_count", collectedCount);
              updateTimers();

              if (collectedCount % 5 === 0) {
                showGifPopup();
              }
            } else {
              const hours = prompt("How many hours until your next bonus?");
              const hoursNum = parseFloat(hours);
              if (!isNaN(hoursNum) && hoursNum > 0) {
                const delay = Date.now() - ((24 - hoursNum) * 60 * 60 * 1000);
                localStorage.setItem("casino_" + casino, delay);
                updateTimers();
              } else {
                checkbox.checked = false;
              }
            }
          }
        });
      });

      document.getElementById("mode-toggle").addEventListener("click", () => {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
      });
    });
  </script>
  <script src="config.js"></script>
  <script src="script.js"></script>
  <script>
    // Dynamically set Discord login button href using client ID from config.js
    document.addEventListener('DOMContentLoaded', function() {
      var btn = document.getElementById('discord-login-btn');
      if (btn && window.DISCORD_CLIENT_ID) {
        const redirect = encodeURIComponent('https://jmenichole.github.io/CollectClock/auth.html');
        btn.href = `https://discord.com/oauth2/authorize?client_id=${window.DISCORD_CLIENT_ID}&redirect_uri=${redirect}&response_type=token&scope=identify`;
      }
    });
  </script>
  <script>
    // Profile image logic (placeholder, replace with real user data if available)
    function showProfileImage(url) {
      const img = document.getElementById('profile-img');
      img.src = url;
      img.style.display = 'block';
    }
    // Example: showProfileImage('https://cdn.discordapp.com/embed/avatars/1.png');
  </script>

</body>
</html>
